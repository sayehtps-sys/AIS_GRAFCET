:root { --bg: #1e1e1e; --panel: #252526; --text: #d4d4d4; --accent: #007acc; --line: #000; --active: #32cd32; --fire: #ff8c00; }
body { margin: 0; display: flex; height: 100vh; background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; overflow: hidden; }

/* Sidebar */
#sidebar { width: 360px; background: var(--panel); border-right: 1px solid #333; display: flex; flex-direction: column; z-index: 10; box-shadow: 2px 0 5px rgba(0,0,0,0.3); }
.toolbar { padding: 10px; background: #333; display: flex; gap: 5px; flex-wrap: wrap; border-bottom: 1px solid #444; }

.btn { background: #3c3c3c; border: 1px solid #555; color: #fff; padding: 6px 10px; cursor: pointer; font-size: 11px; border-radius: 2px; }
.btn:hover { background: var(--accent); border-color: var(--accent); }

/* Simulation Buttons */
.btn-sim { font-weight: bold; border: 1px solid #666; }
.btn-play { background: #2e7d32; }
.btn-stop { background: #c62828; }
.btn-reset { background: #f57f17; color: #000; }

.editor-wrap { flex: 1; position: relative; }
textarea { width: 100%; height: 100%; background: #1e1e1e; color: #9cdcfe; border: none; padding: 15px; box-sizing: border-box; resize: none; outline: none; font-family: 'Consolas', monospace; font-size: 13px; line-height: 1.5; white-space: pre; }

/* Canvas */
#canvas-container { flex: 1; background: #f0f0f0; position: relative; overflow: hidden; cursor: grab; }
#canvas-container:active { cursor: grabbing; }

/* Controls */
.zoom-controls { position: absolute; bottom: 20px; right: 20px; display: flex; gap: 5px; background: #333; padding: 5px; border-radius: 4px; border: 1px solid #555; }
.status-bar { position: absolute; top: 10px; right: 20px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 4px; font-size: 12px; pointer-events: none; }

/* SVG */
svg { width: 100%; height: 100%; display: block; }

/* Interactive Elements */
.node-group { cursor: move; transition: transform 0.1s; }
.loop-handle { stroke: transparent; stroke-width: 30px; cursor: col-resize; fill: none; }
.loop-handle:hover { stroke: rgba(0, 122, 204, 0.1); }

/* Styles & Animation Classes */
.box-step { fill: #fff; stroke: #000; stroke-width: 2px; transition: fill 0.3s ease; }
.box-init { fill: none; stroke: #000; stroke-width: 1px; }
.box-act { fill: #fff; stroke: #000; stroke-width: 1px; pointer-events: none; }

.line-trans { stroke: #000; stroke-width: 3px; stroke-linecap: square; transition: stroke 0.2s; }

/* Animation States */
.step-active .box-step { fill: var(--active) !important; stroke: #006400; }
.trans-firing .line-trans { stroke: var(--fire) !important; stroke-width: 5px; }

.bar-and-outer { stroke: #000; stroke-width: 5px; stroke-linecap: butt; }
.bar-and-inner { stroke: #f0f0f0; stroke-width: 2px; stroke-linecap: butt; }
.bar-or { stroke: #000; stroke-width: 2px; }

.path-conn { fill: none; stroke: #000; stroke-width: 1.5px; stroke-linejoin: round; pointer-events: none; }
.arrow-head { fill: #000; stroke: none; pointer-events: none; }

text { font-family: 'Arial', sans-serif; fill: #000; dominant-baseline: middle; user-select: none; pointer-events: none; }
.lbl-step { text-anchor: middle; font-weight: bold; font-size: 14px; }
.lbl-cond { text-anchor: start; font-size: 11px; font-weight: bold; font-family: 'Courier New'; }
.bg-cond { fill: rgba(255,255,255,0.85); }


/* Viewer Mode Specific Styles */
body.viewer-mode {
    display: flex;
    flex-direction: column;
    background: #1e1e1e;
    overflow: hidden;
}

.top-nav {
    height: 60px;
    background: #252526;
    display: flex;
    align-items: center;
    padding: 0 20px;
    gap: 30px;
    border-bottom: 2px solid #333;
    box-shadow: 0 2px 10px rgba(0,0,0,0.5);
}

.logo {
    font-weight: bold;
    color: var(--accent);
    font-size: 1.2rem;
    letter-spacing: 1px;
}

.controls-group {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #ccc;
    font-size: 14px;
}

#system-select {
    background: #3c3c3c;
    color: white;
    border: 1px solid #555;
    padding: 5px 10px;
    border-radius: 4px;
    outline: none;
}

.animation-controls {
    display: flex;
    gap: 10px;
    margin-left: auto;
}

#main-viewer {
    flex: 1;
    display: flex;
    width: 100vw;
}

#grafcet-panel, #system-panel {
    flex: 1;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

#grafcet-panel {
    border-right: 2px solid #333;
    background: #f0f0f0; /* Light background for Grafcet readability */
}

#system-panel {
    background: #252526; /* Dark background for the animation */
}

.panel-label {
    position: absolute;
    top: 10px;
    left: 10px;
    background: rgba(0,0,0,0.5);
    color: white;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 10px;
    font-weight: bold;
    z-index: 5;
    pointer-events: none;
    text-transform: uppercase;
}

#twin-container {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content:center;
    align-items: center;
}

#twin-container svg {
    max-width: 90%;
    max-height: 90%;
}

/* Ensure Grafcet canvas takes full space */
#canvas-container {
    width: 100%;
    height: 100%;
}

